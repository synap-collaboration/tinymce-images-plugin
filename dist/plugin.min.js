"use strict";function initPlugin(){var a=function(a,b){// We use TinyMCE's editor.dom here (rather than document.createElement) as it is empirically more reliable within the editor
var c=a.dom.create("img",{id:"tinymce-new-image-".concat(b.name)});!c&&Honeybadger&&Honeybadger.notify({desc:"Could not create img tag",fileObj:b}),a.selection.setNode(c);// Get Base64 data of the image so that the user sees the image right away
var d=new FileReader;d.readAsDataURL(b),d.onload=function(){var c=d.result,e=a.dom.select("*[id=\"tinymce-new-image-".concat(b.name,"\"]"))[0];!e&&Honeybadger&&Honeybadger.notify({desc:"Could not find img after reading base64 data",fileObj:b}),e.setAttribute("src",c);var f=a.getParam("images_upload_handler");f(b,function(c){var d=a.dom.select("*[id=\"tinymce-new-image-".concat(b.name,"\"]"))[0];// If the user deletes the image before the upload completes, img won't exist
return d&&(d.setAttribute("src",c),d.removeAttribute("id")),a.getContent()},function(){a.dom.remove("*[id=\"tinymce-new-image-".concat(b.name,"\"]")),a.getParam("image_conversion_error_handler")()})},d.onerror=function(){d.abort(),console.error("Failed to read base64 image data"),Honeybadger&&Honeybadger.notify({desc:"Failed to read base64 image data",fileObj:b}),a.dom.remove("*[id=\"tinymce-new-image-".concat(b.name,"\"]")),a.getParam("image_conversion_error_handler")()}};tinymce.create("tinymce.plugins.SynapImages",{init:function init(b){b.addButton("upload-button",{icon:"image",tooltip:"Insert an image",onClick:function onClick(){var c=document.createElement("input");c.setAttribute("type","file"),c.setAttribute("accept","image/*"),c.onclick=function(){this.value=null},c.onchange=function(c){c.preventDefault();var d=c.target.files;d.length&&0<d.length&&a(b,d[0])},c.click()}})},getInfo:function getInfo(){return{longname:"synap-images",author:"Jesse Cooper",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add("synap-images",tinymce.plugins.SynapImages)}initPlugin();
